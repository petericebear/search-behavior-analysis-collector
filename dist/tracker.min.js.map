{"version":3,"file":"tracker.min.js","mappings":"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","sources":["webpack://SearchBehaviorAnalysisCollector/webpack/universalModuleDefinition","webpack://SearchBehaviorAnalysisCollector/./src/tracker.js","webpack://SearchBehaviorAnalysisCollector/webpack/bootstrap","webpack://SearchBehaviorAnalysisCollector/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SearchBehaviorAnalysisCollector\"] = factory();\n\telse\n\t\troot[\"SearchBehaviorAnalysisCollector\"] = factory();\n})(this, () => {\nreturn ","class SearchBehaviorAnalysisCollector {\n  constructor(config = {}) {\n    this.config = {\n      endpoint: config.endpoint || '/api/track',\n      metricsEndpoint: config.metricsEndpoint || '/api/metrics',\n      selector: config.selector || '.trackable-item',\n      dataAttribute: config.dataAttribute || 'data-item-id',\n      searchRequestIdAttribute: config.searchRequestIdAttribute || 'data-search-request-id',\n      sessionTimeout: config.sessionTimeout || 30 * 60 * 1000, // 30 minutes\n      batchSize: config.batchSize || 10,\n      sendInterval: config.sendInterval || 10000, // 10 seconds\n      sessionId: config.sessionId || null, // Allow session ID injection\n      searchRequestId: config.searchRequestId || null, // Allow searchRequestId injection\n      bearerToken: config.bearerToken || null, // Optional bearer token for authentication\n      performanceMetricsEnabled: config.performanceMetricsEnabled !== false, // Default to true\n    };\n\n    this.events = [];\n    this.performanceMetrics = []; // Separate array for performance metrics\n    this.sessionId = this.getOrCreateSessionId();\n    this.browserInfo = this.getBrowserInfo();\n    this.colorIdentifier = this.getOrCreateColorIdentifier();\n    this.utmParams = this.getUtmParameters();\n    this.currentPath = window.location.pathname;\n    this.setupEventListeners();\n   \n    if (this.config.performanceMetricsEnabled) {\n      this.setupPerformanceObserver();\n    }\n    \n    // Check session expiration periodically\n    this._sessionInterval = setInterval(() => this.checkSessionExpiration(), 60000); // Check every minute\n    // Batch sending interval\n    this._batchInterval = setInterval(() => {\n      if (this.events.length > 0) {\n        this.sendEvents();\n      }\n    }, this.config.sendInterval);\n  }\n\n  getBrowserInfo() {\n    const ua = navigator.userAgent;\n    const browserInfo = {\n      userAgent: ua,\n      language: navigator.language,\n      platform: navigator.userAgentData?.platform || navigator.platform,\n      screenWidth: window.screen.width,\n      screenHeight: window.screen.height,\n      viewportWidth: window.innerWidth,\n      viewportHeight: window.innerHeight,\n      devicePixelRatio: window.devicePixelRatio,\n      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n      timestamp: new Date().toISOString(),\n      domain: window.location.hostname,\n      path: window.location.pathname,\n      connection: navigator.connection ? {\n        effectiveType: navigator.connection.effectiveType,\n        downlink: navigator.connection.downlink,\n        rtt: navigator.connection.rtt,\n        saveData: navigator.connection.saveData\n      } : null,\n      memory: navigator.deviceMemory ? {\n        deviceMemory: navigator.deviceMemory,\n        hardwareConcurrency: navigator.hardwareConcurrency\n      } : null\n    };\n\n    // Detect browser\n    if (ua.includes('Chrome')) browserInfo.browser = 'Chrome';\n    else if (ua.includes('Firefox')) browserInfo.browser = 'Firefox';\n    else if (ua.includes('Safari')) browserInfo.browser = 'Safari';\n    else if (ua.includes('Edge')) browserInfo.browser = 'Edge';\n    else browserInfo.browser = 'Unknown';\n\n    return browserInfo;\n  }\n\n  setupPerformanceObserver() {\n    // Disconnect existing observers if any\n    if (this._observers) {\n      this._observers.forEach(observer => observer.disconnect());\n    }\n    this._observers = [];\n\n    if ('PerformanceObserver' in window) {\n      // LCP Observer\n      const lcpObserver = new PerformanceObserver((entryList) => {\n        const entries = entryList.getEntries();\n        const lastEntry = entries[entries.length - 1];\n        this.trackPerformanceMetric({\n          type: 'LCP',\n          value: lastEntry.startTime,\n          element: lastEntry.element?.tagName || 'unknown',\n          size: lastEntry.size,\n          url: lastEntry.url\n        });\n      });\n      lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });\n      this._observers.push(lcpObserver);\n\n      // FCP Observer\n      const fcpObserver = new PerformanceObserver((entryList) => {\n        const entries = entryList.getEntries();\n        this.trackPerformanceMetric({\n          type: 'FCP',\n          value: entries[0].startTime\n        });\n      });\n      fcpObserver.observe({ entryTypes: ['paint'] });\n      this._observers.push(fcpObserver);\n\n      // FID Observer (First Input Delay)\n      const fidObserver = new PerformanceObserver((entryList) => {\n        const entries = entryList.getEntries();\n        entries.forEach(entry => {\n          this.trackPerformanceMetric({\n            type: 'FID',\n            value: entry.processingStart - entry.startTime,\n            name: entry.name\n          });\n        });\n      });\n      fidObserver.observe({ entryTypes: ['first-input'] });\n      this._observers.push(fidObserver);\n\n      // CLS Observer (Cumulative Layout Shift)\n      const clsObserver = new PerformanceObserver((entryList) => {\n        let clsValue = 0;\n        const entries = entryList.getEntries();\n        entries.forEach(entry => {\n          if (!entry.hadRecentInput) {\n            clsValue += entry.value;\n          }\n        });\n        this.trackPerformanceMetric({\n          type: 'CLS',\n          value: clsValue\n        });\n      });\n      clsObserver.observe({ entryTypes: ['layout-shift'] });\n      this._observers.push(clsObserver);\n\n      // Resource Timing Observer\n      const resourceObserver = new PerformanceObserver((entryList) => {\n        const entries = entryList.getEntries();\n        entries.forEach(entry => {\n          this.trackPerformanceMetric({\n            type: 'RESOURCE',\n            name: entry.name,\n            duration: entry.duration,\n            size: entry.transferSize,\n            initiatorType: entry.initiatorType\n          });\n        });\n      });\n      resourceObserver.observe({ entryTypes: ['resource'] });\n      this._observers.push(resourceObserver);\n\n      // Navigation Timing\n      const navigationEntry = performance.getEntriesByType('navigation')[0];\n      if (navigationEntry) {\n        this.trackPerformanceMetric({\n          type: 'NAVIGATION',\n          ttfb: navigationEntry.responseStart - navigationEntry.requestStart,\n          domContentLoaded: navigationEntry.domContentLoadedEventEnd - navigationEntry.startTime,\n          load: navigationEntry.loadEventEnd - navigationEntry.startTime,\n          dns: navigationEntry.domainLookupEnd - navigationEntry.domainLookupStart,\n          tcp: navigationEntry.connectEnd - navigationEntry.connectStart,\n          request: navigationEntry.responseEnd - navigationEntry.requestStart\n        });\n      }\n    }\n  }\n\n  trackPerformanceMetric(metricData) {\n    this.performanceMetrics.push({\n      ...metricData,\n      timestamp: new Date().toISOString(),\n      sessionId: this.sessionId\n    });\n\n    // Send performance metrics immediately to ensure timely data\n    this.sendPerformanceMetrics();\n  }\n\n  async sendPerformanceMetrics() {\n    if (this.performanceMetrics.length === 0) return;\n\n    const metricsToSend = [...this.performanceMetrics];\n    this.performanceMetrics = [];\n\n    const data = {\n      performanceMetrics: metricsToSend,\n      sessionId: this.sessionId,\n      colorIdentifier: this.colorIdentifier,\n      browserInfo: this.browserInfo,\n      timestamp: new Date().toISOString()\n    };\n\n    try {\n      const headers = {\n        'Content-Type': 'application/json'\n      };\n\n      if (this.config.bearerToken) {\n        headers['Authorization'] = `Bearer ${this.config.bearerToken}`;\n      }\n\n      const response = await fetch(`${this.config.metricsEndpoint}`, {\n        method: 'POST',\n        headers,\n        body: JSON.stringify(data),\n      });\n\n      if (!response.ok) {\n        // Put metrics back in the queue\n        this.performanceMetrics = [...metricsToSend, ...this.performanceMetrics];\n        throw new Error('Failed to send performance metrics');\n      }\n    } catch (error) {\n      console.error('Error sending performance metrics:', error);\n      // Put metrics back in the queue\n      this.performanceMetrics = [...metricsToSend, ...this.performanceMetrics];\n    }\n  }\n\n  getOrCreateSessionId() {\n    // If session ID is provided in config, use it\n    if (this.config.sessionId) {\n      localStorage.setItem('tracker_session_id', this.config.sessionId);\n      localStorage.setItem('tracker_session_timestamp', new Date().toISOString());\n      return this.config.sessionId;\n    }\n\n    // Get existing session ID from localStorage\n    const sessionId = localStorage.getItem('tracker_session_id');\n    const sessionTimestamp = localStorage.getItem('tracker_session_timestamp');\n\n    // Check if session exists and hasn't expired\n    if (sessionId && sessionTimestamp) {\n      const sessionAge = new Date().getTime() - new Date(sessionTimestamp).getTime();\n      if (sessionAge < this.config.sessionTimeout) {\n        return sessionId;\n      }\n    }\n\n    // Create new session if none exists or if expired\n    const newSessionId = this.generateUUID();\n    localStorage.setItem('tracker_session_id', newSessionId);\n    localStorage.setItem('tracker_session_timestamp', new Date().toISOString());\n    return newSessionId;\n  }\n\n  generateUUID() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      const r = Math.random() * 16 | 0;\n      const v = c === 'x' ? r : (r & 0x3 | 0x8);\n      return v.toString(16);\n    });\n  }\n\n  setupEventListeners() {\n    // Store listener references for cleanup\n    this._clickListener = (event) => {\n      const target = event.target.closest(this.config.selector);\n      if (target) {\n        const itemId = target.getAttribute(this.config.dataAttribute);\n        if (itemId) {\n          // Find all matching elements and get the index of the clicked one\n          const allElements = document.querySelectorAll(this.config.selector);\n          const position = Array.from(allElements).indexOf(target) + 1; // +1 for 1-based indexing\n          \n          // Get searchRequestId from data attribute or use the one from config\n          const searchRequestId = target.getAttribute(this.config.searchRequestIdAttribute) || this.config.searchRequestId;\n          \n          this.trackClick({\n            itemId,\n            position,\n            searchRequestId,\n            timestamp: new Date().toISOString(),\n          });\n        }\n      }\n    };\n    document.addEventListener('click', this._clickListener);\n\n    // Track page visibility changes\n    this._visibilityListener = () => {\n      this.trackEvent('visibility_change', {\n        state: document.visibilityState\n      });\n    };\n    document.addEventListener('visibilitychange', this._visibilityListener);\n\n    // Track path changes - store original methods as instance properties\n    this._originalPushState = history.pushState;\n    this._originalReplaceState = history.replaceState;\n\n    history.pushState = function(state, title, url) {\n      this._originalPushState.call(history, state, title, url);\n      this.handlePathChange();\n    }.bind(this);\n\n    history.replaceState = function(state, title, url) {\n      this._originalReplaceState.call(history, state, title, url);\n      this.handlePathChange();\n    }.bind(this);\n\n    // Listen for popstate events (back/forward navigation)\n    this._popstateListener = () => {\n      this.handlePathChange();\n    };\n    window.addEventListener('popstate', this._popstateListener);\n\n    // Track page unload\n    this._beforeunloadListener = () => {\n      this.sendEvents(true); // Force send on page unload\n    };\n    window.addEventListener('beforeunload', this._beforeunloadListener);\n  }\n\n  handlePathChange() {\n    const newPath = window.location.pathname;\n    if (newPath !== this.currentPath) {\n      this.currentPath = newPath;\n      this.browserInfo = this.getBrowserInfo(); // Update browser info with new path\n      \n      // Reset performance observers for the new page\n      if (this.config.performanceMetricsEnabled) {\n        this.setupPerformanceObserver();\n      }\n    }\n  }\n\n  trackEvent(eventName, eventData = {}) {\n    this.events.push({\n      type: 'custom_event',\n      name: eventName,\n      data: eventData,\n      sessionId: this.sessionId,\n      timestamp: new Date().toISOString()\n    });\n\n    if (this.events.length >= this.config.batchSize) {\n      this.sendEvents();\n    }\n  }\n\n  trackClick(clickData) {\n    this.events.push({\n      type: 'click',\n      ...clickData,\n      sessionId: this.sessionId\n    });\n\n    if (this.events.length >= this.config.batchSize) {\n      this.sendEvents();\n    }\n  }\n\n  async sendEvents(useSendBeacon = false) {\n    if (this.events.length === 0) return;\n\n    const eventsToSend = [...this.events];\n    this.events = [];\n\n    const data = {\n      events: eventsToSend,\n      sessionId: this.sessionId,\n      colorIdentifier: this.colorIdentifier,\n      browserInfo: this.browserInfo,\n      utmParams: this.utmParams,\n      timestamp: new Date().toISOString()\n    };\n\n    try {\n      if (useSendBeacon && navigator.sendBeacon) {\n        // Use sendBeacon for more reliable sending, especially during page unload\n        const success = navigator.sendBeacon(\n          this.config.endpoint,\n          new Blob([JSON.stringify(data)], { type: 'application/json' })\n        );\n        \n        if (!success) {\n          // If sendBeacon fails, put events back in the queue\n          this.events = [...eventsToSend, ...this.events];\n          throw new Error('Failed to send events via sendBeacon');\n        }\n      } else {\n        // Fallback to fetch for normal operation\n        const headers = {\n          'Content-Type': 'application/json'\n        };\n\n        // Add bearer token to headers if provided\n        if (this.config.bearerToken) {\n          headers['Authorization'] = `Bearer ${this.config.bearerToken}`;\n        }\n\n        const response = await fetch(this.config.endpoint, {\n          method: 'POST',\n          headers,\n          body: JSON.stringify(data),\n        });\n\n        if (!response.ok) {\n          // Put events back in the queue\n          this.events = [...eventsToSend, ...this.events];\n          throw new Error('Failed to send events');\n        }\n        // Try to parse JSON and log error if it fails\n        try {\n          await response.json();\n        } catch (jsonError) {\n          console.error('Error sending events:', jsonError);\n          this.events = [...eventsToSend, ...this.events];\n        }\n      }\n    } catch (error) {\n      console.error('Error sending events:', error);\n      // Put events back in the queue\n      this.events = [...eventsToSend, ...this.events];\n    }\n  }\n\n  resetSession() {\n    localStorage.removeItem('tracker_session_id');\n    localStorage.removeItem('tracker_session_timestamp');\n    this.sessionId = this.getOrCreateSessionId();\n  }\n\n  // Add method to check session expiration\n  checkSessionExpiration() {\n    const sessionTimestamp = localStorage.getItem('tracker_session_timestamp');\n    if (sessionTimestamp) {\n      const sessionAge = new Date().getTime() - new Date(sessionTimestamp).getTime();\n      if (sessionAge >= this.config.sessionTimeout) {\n        this.resetSession();\n      }\n    }\n  }\n\n  // Utility method to track conversion events\n  trackConversion(conversionData) {\n    this.trackEvent('conversion', conversionData);\n    this.resetSession();\n  }\n\n  getOrCreateColorIdentifier() {\n    let colorIdentifier = localStorage.getItem('colorschema_identifier');\n    if (!colorIdentifier) {\n      // Generate two random colors for anonymous identification\n      const color1 = this.generateRandomColor();\n      const color2 = this.generateRandomColor();\n      colorIdentifier = `${color1}-${color2}`;\n      localStorage.setItem('colorschema_identifier', colorIdentifier);\n    }\n    return colorIdentifier;\n  }\n\n  generateRandomColor() {\n    const letters = '0123456789ABCDEF';\n    let color = '#';\n    for (let i = 0; i < 6; i++) {\n      color += letters[Math.floor(Math.random() * 16)];\n    }\n    return color;\n  }\n\n  getUtmParameters() {\n    const urlParams = new URLSearchParams(window.location.search);\n    const utmParams = {};\n    const utmKeys = ['source', 'medium', 'campaign', 'term', 'content'];\n    \n    utmKeys.forEach(key => {\n      const value = urlParams.get(`utm_${key}`);\n      if (value) {\n        utmParams[`utm_${key}`] = value;\n      }\n    });\n\n    return utmParams;\n  }\n\n  // Add method to update searchRequestId\n  updateSearchRequestId(searchRequestId) {\n    this.config.searchRequestId = searchRequestId;\n  }\n\n  destroy() {\n    // Clear intervals\n    if (this._sessionInterval) {\n      clearInterval(this._sessionInterval);\n    }\n    if (this._batchInterval) {\n      clearInterval(this._batchInterval);\n    }\n\n    // Disconnect performance observers\n    if (this._observers) {\n      this._observers.forEach(observer => observer.disconnect());\n    }\n\n    // Remove event listeners\n    if (this._clickListener) {\n      document.removeEventListener('click', this._clickListener);\n    }\n    if (this._visibilityListener) {\n      document.removeEventListener('visibilitychange', this._visibilityListener);\n    }\n    if (this._popstateListener) {\n      window.removeEventListener('popstate', this._popstateListener);\n    }\n    if (this._beforeunloadListener) {\n      window.removeEventListener('beforeunload', this._beforeunloadListener);\n    }\n\n    // Restore original history methods\n    if (this._originalPushState) {\n      history.pushState = this._originalPushState;\n    }\n    if (this._originalReplaceState) {\n      history.replaceState = this._originalReplaceState;\n    }\n  }\n}\n\n// Export for both module and global usage\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = SearchBehaviorAnalysisCollector;\n  module.exports.default = SearchBehaviorAnalysisCollector;\n} else {\n  window.SearchBehaviorAnalysisCollector = SearchBehaviorAnalysisCollector;\n} ","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(140);\n"],"names":["root","factory","exports","module","define","amd","this","SearchBehaviorAnalysisCollector","constructor","config","endpoint","metricsEndpoint","selector","dataAttribute","searchRequestIdAttribute","sessionTimeout","batchSize","sendInterval","sessionId","searchRequestId","bearerToken","performanceMetricsEnabled","events","performanceMetrics","getOrCreateSessionId","browserInfo","getBrowserInfo","colorIdentifier","getOrCreateColorIdentifier","utmParams","getUtmParameters","currentPath","window","location","pathname","setupEventListeners","setupPerformanceObserver","_sessionInterval","setInterval","checkSessionExpiration","_batchInterval","length","sendEvents","ua","navigator","userAgent","language","platform","userAgentData","screenWidth","screen","width","screenHeight","height","viewportWidth","innerWidth","viewportHeight","innerHeight","devicePixelRatio","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","timestamp","Date","toISOString","domain","hostname","path","connection","effectiveType","downlink","rtt","saveData","memory","deviceMemory","hardwareConcurrency","includes","browser","_observers","forEach","observer","disconnect","lcpObserver","PerformanceObserver","entryList","entries","getEntries","lastEntry","trackPerformanceMetric","type","value","startTime","element","tagName","size","url","observe","entryTypes","push","fcpObserver","fidObserver","entry","processingStart","name","clsObserver","clsValue","hadRecentInput","resourceObserver","duration","transferSize","initiatorType","navigationEntry","performance","getEntriesByType","ttfb","responseStart","requestStart","domContentLoaded","domContentLoadedEventEnd","load","loadEventEnd","dns","domainLookupEnd","domainLookupStart","tcp","connectEnd","connectStart","request","responseEnd","metricData","sendPerformanceMetrics","metricsToSend","data","headers","fetch","method","body","JSON","stringify","ok","Error","error","console","localStorage","setItem","getItem","sessionTimestamp","getTime","newSessionId","generateUUID","replace","c","r","Math","random","toString","_clickListener","event","target","closest","itemId","getAttribute","allElements","document","querySelectorAll","position","Array","from","indexOf","trackClick","addEventListener","_visibilityListener","trackEvent","state","visibilityState","_originalPushState","history","pushState","_originalReplaceState","replaceState","title","call","handlePathChange","bind","_popstateListener","_beforeunloadListener","newPath","eventName","eventData","clickData","useSendBeacon","eventsToSend","sendBeacon","Blob","response","json","jsonError","resetSession","removeItem","trackConversion","conversionData","generateRandomColor","color","i","floor","urlParams","URLSearchParams","search","key","get","updateSearchRequestId","destroy","clearInterval","removeEventListener","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__"],"ignoreList":[],"sourceRoot":""}